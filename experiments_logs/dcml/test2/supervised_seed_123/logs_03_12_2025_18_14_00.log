=============================================
Dataset: Ehrenreich_Spectrogram
Method:  TS-TCC
Mode:    supervised
=============================================
Data loaded ...
Training started ....
Epoch : 1
Train Loss: 0.2411 | F1: 0.0255 | Precision: 0.1322 | Recall: 0.0141
Valid Loss: 0.1908 | F1: 0.0530 | Precision: 0.4444 | Recall: 0.0282

New best valid loss: 0.1908 at epoch 1, saving model checkpoint.
Epoch : 2
Train Loss: 0.1948 | F1: 0.0835 | Precision: 0.5604 | Recall: 0.0451
Valid Loss: 0.2007 | F1: 0.0909 | Precision: 0.2353 | Recall: 0.0563

Epoch : 3
Train Loss: 0.1807 | F1: 0.0913 | Precision: 0.4914 | Recall: 0.0504
Valid Loss: 0.1795 | F1: 0.1287 | Precision: 0.3793 | Recall: 0.0775

New best valid loss: 0.1795 at epoch 3, saving model checkpoint.
Epoch : 4
Train Loss: 0.1752 | F1: 0.1366 | Precision: 0.5298 | Recall: 0.0784
Valid Loss: 0.1718 | F1: 0.2111 | Precision: 0.5000 | Recall: 0.1338

New best valid loss: 0.1718 at epoch 4, saving model checkpoint.
Epoch : 5
Train Loss: 0.1616 | F1: 0.1838 | Precision: 0.5556 | Recall: 0.1101
Valid Loss: 0.2091 | F1: 0.2656 | Precision: 0.3232 | Recall: 0.2254

Epoch : 6
Train Loss: 0.1456 | F1: 0.2583 | Precision: 0.5994 | Recall: 0.1646
Valid Loss: 0.1533 | F1: 0.2558 | Precision: 0.7333 | Recall: 0.1549

New best valid loss: 0.1533 at epoch 6, saving model checkpoint.
Epoch : 7
Train Loss: 0.1335 | F1: 0.3259 | Precision: 0.6281 | Recall: 0.2201
Valid Loss: 0.1620 | F1: 0.3524 | Precision: 0.4706 | Recall: 0.2817

Epoch : 8
Train Loss: 0.1190 | F1: 0.4113 | Precision: 0.6733 | Recall: 0.2960
Valid Loss: 0.1535 | F1: 0.3932 | Precision: 0.5000 | Recall: 0.3239

Epoch : 9
Train Loss: 0.1071 | F1: 0.5043 | Precision: 0.7264 | Recall: 0.3862
Valid Loss: 0.1249 | F1: 0.4273 | Precision: 0.6026 | Recall: 0.3310

New best valid loss: 0.1249 at epoch 9, saving model checkpoint.
Epoch : 10
Train Loss: 0.0967 | F1: 0.5447 | Precision: 0.7265 | Recall: 0.4356
Valid Loss: 0.1253 | F1: 0.5094 | Precision: 0.5440 | Recall: 0.4789

Epoch : 11
Train Loss: 0.0844 | F1: 0.6237 | Precision: 0.7746 | Recall: 0.5221
Valid Loss: 0.1134 | F1: 0.5207 | Precision: 0.6300 | Recall: 0.4437

New best valid loss: 0.1134 at epoch 11, saving model checkpoint.
Epoch : 12
Train Loss: 0.0773 | F1: 0.6587 | Precision: 0.7972 | Recall: 0.5612
Valid Loss: 0.1216 | F1: 0.5648 | Precision: 0.5346 | Recall: 0.5986

Epoch : 13
Train Loss: 0.0701 | F1: 0.6986 | Precision: 0.8180 | Recall: 0.6097
Valid Loss: 0.0985 | F1: 0.6077 | Precision: 0.6695 | Recall: 0.5563

New best valid loss: 0.0985 at epoch 13, saving model checkpoint.
Epoch : 14
Train Loss: 0.0622 | F1: 0.7414 | Precision: 0.8410 | Recall: 0.6628
Valid Loss: 0.1155 | F1: 0.6220 | Precision: 0.5484 | Recall: 0.7183

Epoch : 15
Train Loss: 0.0617 | F1: 0.7315 | Precision: 0.8183 | Recall: 0.6614
Valid Loss: 0.0953 | F1: 0.5571 | Precision: 0.7922 | Recall: 0.4296

New best valid loss: 0.0953 at epoch 15, saving model checkpoint.
Epoch : 16
Train Loss: 0.0561 | F1: 0.7687 | Precision: 0.8440 | Recall: 0.7057
Valid Loss: 0.0921 | F1: 0.6119 | Precision: 0.6508 | Recall: 0.5775

New best valid loss: 0.0921 at epoch 16, saving model checkpoint.
Epoch : 17
Train Loss: 0.0514 | F1: 0.7889 | Precision: 0.8653 | Recall: 0.7249
Valid Loss: 0.0807 | F1: 0.6406 | Precision: 0.7193 | Recall: 0.5775

New best valid loss: 0.0807 at epoch 17, saving model checkpoint.
Epoch : 18
Train Loss: 0.0475 | F1: 0.8049 | Precision: 0.8685 | Recall: 0.7500
Valid Loss: 0.0855 | F1: 0.6504 | Precision: 0.7692 | Recall: 0.5634

Epoch : 19
Train Loss: 0.0457 | F1: 0.8162 | Precision: 0.8759 | Recall: 0.7641
Valid Loss: 0.0809 | F1: 0.6879 | Precision: 0.6929 | Recall: 0.6831

Epoch : 20
Train Loss: 0.0409 | F1: 0.8283 | Precision: 0.8832 | Recall: 0.7797
Valid Loss: 0.0834 | F1: 0.6899 | Precision: 0.7672 | Recall: 0.6268

Epoch : 21
Train Loss: 0.0387 | F1: 0.8431 | Precision: 0.8932 | Recall: 0.7984
Valid Loss: 0.0738 | F1: 0.6794 | Precision: 0.7417 | Recall: 0.6268

New best valid loss: 0.0738 at epoch 21, saving model checkpoint.
Epoch : 22
Train Loss: 0.0364 | F1: 0.8548 | Precision: 0.8911 | Recall: 0.8213
Valid Loss: 0.0650 | F1: 0.7490 | Precision: 0.8291 | Recall: 0.6831

New best valid loss: 0.0650 at epoch 22, saving model checkpoint.
Epoch : 23
Train Loss: 0.0350 | F1: 0.8571 | Precision: 0.8954 | Recall: 0.8220
Valid Loss: 0.0835 | F1: 0.7432 | Precision: 0.7143 | Recall: 0.7746

Epoch : 24
Train Loss: 0.0329 | F1: 0.8718 | Precision: 0.9139 | Recall: 0.8333
Valid Loss: 0.0691 | F1: 0.7168 | Precision: 0.7299 | Recall: 0.7042

Epoch : 25
Train Loss: 0.0297 | F1: 0.8846 | Precision: 0.9200 | Recall: 0.8519
Valid Loss: 0.0835 | F1: 0.6992 | Precision: 0.7500 | Recall: 0.6549

Epoch : 26
Train Loss: 0.0303 | F1: 0.8771 | Precision: 0.9157 | Recall: 0.8415
Valid Loss: 0.0745 | F1: 0.7121 | Precision: 0.7705 | Recall: 0.6620

Epoch : 27
Train Loss: 0.0285 | F1: 0.8866 | Precision: 0.9244 | Recall: 0.8519
Valid Loss: 0.0669 | F1: 0.7445 | Precision: 0.7727 | Recall: 0.7183

Epoch : 28
Train Loss: 0.0235 | F1: 0.9154 | Precision: 0.9455 | Recall: 0.8871
Valid Loss: 0.0688 | F1: 0.7491 | Precision: 0.8000 | Recall: 0.7042

Epoch : 29
Train Loss: 0.0270 | F1: 0.8940 | Precision: 0.9239 | Recall: 0.8661
Valid Loss: 0.0665 | F1: 0.7368 | Precision: 0.7903 | Recall: 0.6901

Epoch : 30
Train Loss: 0.0233 | F1: 0.9045 | Precision: 0.9316 | Recall: 0.8790
Valid Loss: 0.0755 | F1: 0.7296 | Precision: 0.6788 | Recall: 0.7887

Epoch : 31
Train Loss: 0.0248 | F1: 0.9043 | Precision: 0.9300 | Recall: 0.8800
Valid Loss: 0.0686 | F1: 0.7402 | Precision: 0.8393 | Recall: 0.6620

Epoch : 32
Train Loss: 0.0213 | F1: 0.9154 | Precision: 0.9308 | Recall: 0.9005
Valid Loss: 0.0764 | F1: 0.6894 | Precision: 0.7459 | Recall: 0.6408

Epoch : 33
Train Loss: 0.0245 | F1: 0.9088 | Precision: 0.9388 | Recall: 0.8807
Valid Loss: 0.0706 | F1: 0.7177 | Precision: 0.8396 | Recall: 0.6268

Epoch : 34
Train Loss: 0.0130 | F1: 0.9530 | Precision: 0.9673 | Recall: 0.9392
Valid Loss: 0.0563 | F1: 0.7765 | Precision: 0.8761 | Recall: 0.6972

New best valid loss: 0.0563 at epoch 34, saving model checkpoint.
Epoch : 35
Train Loss: 0.0091 | F1: 0.9700 | Precision: 0.9828 | Recall: 0.9576
Valid Loss: 0.0511 | F1: 0.8031 | Precision: 0.8889 | Recall: 0.7324

New best valid loss: 0.0511 at epoch 35, saving model checkpoint.
Epoch : 36
Train Loss: 0.0071 | F1: 0.9787 | Precision: 0.9866 | Recall: 0.9709
Valid Loss: 0.0523 | F1: 0.7761 | Precision: 0.8254 | Recall: 0.7324

Epoch : 37
Train Loss: 0.0065 | F1: 0.9819 | Precision: 0.9849 | Recall: 0.9789
Valid Loss: 0.0500 | F1: 0.7984 | Precision: 0.8879 | Recall: 0.7254

New best valid loss: 0.0500 at epoch 37, saving model checkpoint.
Epoch : 38
Train Loss: 0.0065 | F1: 0.9778 | Precision: 0.9839 | Recall: 0.9718
Valid Loss: 0.0499 | F1: 0.7891 | Precision: 0.8860 | Recall: 0.7113

New best valid loss: 0.0499 at epoch 38, saving model checkpoint.
Epoch : 39
Train Loss: 0.0057 | F1: 0.9854 | Precision: 0.9885 | Recall: 0.9824
Valid Loss: 0.0505 | F1: 0.7938 | Precision: 0.8870 | Recall: 0.7183

Epoch : 40
Train Loss: 0.0054 | F1: 0.9850 | Precision: 0.9902 | Recall: 0.9798
Valid Loss: 0.0487 | F1: 0.7786 | Precision: 0.8500 | Recall: 0.7183

New best valid loss: 0.0487 at epoch 40, saving model checkpoint.
Loading best model from epoch 40
Collecting validation probabilities for threshold optimization...
Threshold optimization results:
Best threshold: 0.271
Best validation F1: 0.8112
Validation positive rate: 4.7%
Evaluating on test set:
1. With default threshold (0.5):
Test Loss: 0.0643 | F1: 0.7584 | Precision: 0.8031 | Recall: 0.7183
2. With optimized threshold (0.271):
Test Loss: 0.0643 | F1: 0.7509 | Precision: 0.7285 | Recall: 0.7746
=== THRESHOLD OPTIMIZATION RESULTS ===
F1 improvement: -0.0075 (from 0.7584 to 0.7509)
Optimal threshold: 0.271 (vs default 0.5)
Best validation loss epoch: 40
################## Training is Done! #########################
Creating transition analysis visualization...
Analysis Results: Precision=0.803, Recall=0.718, F1=0.758
TP=102, FP=25, FN=40, TN=2849
Training time is : 0:09:21.588244

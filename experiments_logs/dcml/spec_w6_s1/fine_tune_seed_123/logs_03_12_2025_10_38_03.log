=============================================
Dataset: Ehrenreich_Spectrogram
Method:  TS-TCC
Mode:    fine_tune
=============================================
Data loaded ...
Training started ....
Epoch : 1
Train Loss: 0.2715 | F1: 0.0422 | Precision: 0.1208 | Recall: 0.0256
Valid Loss: 0.2459 | F1: 0.0854 | Precision: 0.3182 | Recall: 0.0493

New best valid loss: 0.2459 at epoch 1, saving model checkpoint.
Epoch : 2
Train Loss: 0.2105 | F1: 0.0571 | Precision: 0.3933 | Recall: 0.0308
Valid Loss: 0.1881 | F1: 0.0140 | Precision: 1.0000 | Recall: 0.0070

New best valid loss: 0.1881 at epoch 2, saving model checkpoint.
Epoch : 3
Train Loss: 0.1876 | F1: 0.0798 | Precision: 0.7273 | Recall: 0.0422
Valid Loss: 0.1787 | F1: 0.0811 | Precision: 1.0000 | Recall: 0.0423

New best valid loss: 0.1787 at epoch 3, saving model checkpoint.
Epoch : 4
Train Loss: 0.1787 | F1: 0.0762 | Precision: 0.6571 | Recall: 0.0405
Valid Loss: 0.1755 | F1: 0.1176 | Precision: 0.8182 | Recall: 0.0634

New best valid loss: 0.1755 at epoch 4, saving model checkpoint.
Epoch : 5
Train Loss: 0.1748 | F1: 0.1115 | Precision: 0.6832 | Recall: 0.0607
Valid Loss: 0.1715 | F1: 0.1299 | Precision: 0.8333 | Recall: 0.0704

New best valid loss: 0.1715 at epoch 5, saving model checkpoint.
Epoch : 6
Train Loss: 0.1726 | F1: 0.1224 | Precision: 0.5652 | Recall: 0.0686
Valid Loss: 0.1772 | F1: 0.0278 | Precision: 1.0000 | Recall: 0.0141

Epoch : 7
Train Loss: 0.1662 | F1: 0.1523 | Precision: 0.5316 | Recall: 0.0889
Valid Loss: 0.1662 | F1: 0.1744 | Precision: 0.5000 | Recall: 0.1056

New best valid loss: 0.1662 at epoch 7, saving model checkpoint.
Epoch : 8
Train Loss: 0.1511 | F1: 0.2458 | Precision: 0.6055 | Recall: 0.1542
Valid Loss: 0.1560 | F1: 0.1939 | Precision: 0.6957 | Recall: 0.1127

New best valid loss: 0.1560 at epoch 8, saving model checkpoint.
Epoch : 9
Train Loss: 0.1382 | F1: 0.3238 | Precision: 0.6143 | Recall: 0.2199
Valid Loss: 0.1559 | F1: 0.3467 | Precision: 0.4699 | Recall: 0.2746

New best valid loss: 0.1559 at epoch 9, saving model checkpoint.
Epoch : 10
Train Loss: 0.1298 | F1: 0.3622 | Precision: 0.6574 | Recall: 0.2500
Valid Loss: 0.1416 | F1: 0.3981 | Precision: 0.5811 | Recall: 0.3028

New best valid loss: 0.1416 at epoch 10, saving model checkpoint.
Epoch : 11
Train Loss: 0.1166 | F1: 0.4509 | Precision: 0.7165 | Recall: 0.3289
Valid Loss: 0.1392 | F1: 0.4018 | Precision: 0.5714 | Recall: 0.3099

New best valid loss: 0.1392 at epoch 11, saving model checkpoint.
Epoch : 12
Train Loss: 0.1078 | F1: 0.5113 | Precision: 0.7134 | Recall: 0.3984
Valid Loss: 0.1251 | F1: 0.5405 | Precision: 0.7500 | Recall: 0.4225

New best valid loss: 0.1251 at epoch 12, saving model checkpoint.
Epoch : 13
Train Loss: 0.0984 | F1: 0.5465 | Precision: 0.7428 | Recall: 0.4322
Valid Loss: 0.1188 | F1: 0.5195 | Precision: 0.6742 | Recall: 0.4225

New best valid loss: 0.1188 at epoch 13, saving model checkpoint.
Epoch : 14
Train Loss: 0.0880 | F1: 0.6164 | Precision: 0.7757 | Recall: 0.5114
Valid Loss: 0.1214 | F1: 0.5432 | Precision: 0.6535 | Recall: 0.4648

Epoch : 15
Train Loss: 0.0816 | F1: 0.6385 | Precision: 0.7853 | Recall: 0.5379
Valid Loss: 0.1222 | F1: 0.5528 | Precision: 0.6538 | Recall: 0.4789

Epoch : 16
Train Loss: 0.0772 | F1: 0.6799 | Precision: 0.8068 | Recall: 0.5875
Valid Loss: 0.1205 | F1: 0.6059 | Precision: 0.5636 | Recall: 0.6549

Epoch : 17
Train Loss: 0.0709 | F1: 0.6962 | Precision: 0.8149 | Recall: 0.6077
Valid Loss: 0.1065 | F1: 0.6116 | Precision: 0.7400 | Recall: 0.5211

New best valid loss: 0.1065 at epoch 17, saving model checkpoint.
Epoch : 18
Train Loss: 0.0643 | F1: 0.7324 | Precision: 0.8289 | Recall: 0.6561
Valid Loss: 0.1055 | F1: 0.5703 | Precision: 0.6404 | Recall: 0.5141

New best valid loss: 0.1055 at epoch 18, saving model checkpoint.
Epoch : 19
Train Loss: 0.0621 | F1: 0.7444 | Precision: 0.8317 | Recall: 0.6737
Valid Loss: 0.0856 | F1: 0.6432 | Precision: 0.8588 | Recall: 0.5141

New best valid loss: 0.0856 at epoch 19, saving model checkpoint.
Epoch : 20
Train Loss: 0.0576 | F1: 0.7666 | Precision: 0.8550 | Recall: 0.6948
Valid Loss: 0.1025 | F1: 0.6449 | Precision: 0.6642 | Recall: 0.6268

Epoch : 21
Train Loss: 0.0539 | F1: 0.7741 | Precision: 0.8513 | Recall: 0.7098
Valid Loss: 0.0878 | F1: 0.6866 | Precision: 0.7302 | Recall: 0.6479

Epoch : 22
Train Loss: 0.0529 | F1: 0.7740 | Precision: 0.8455 | Recall: 0.7137
Valid Loss: 0.0814 | F1: 0.6929 | Precision: 0.7029 | Recall: 0.6831

New best valid loss: 0.0814 at epoch 22, saving model checkpoint.
Epoch : 23
Train Loss: 0.0514 | F1: 0.7909 | Precision: 0.8628 | Recall: 0.7300
Valid Loss: 0.0857 | F1: 0.6256 | Precision: 0.8353 | Recall: 0.5000

Epoch : 24
Train Loss: 0.0470 | F1: 0.8093 | Precision: 0.8634 | Recall: 0.7617
Valid Loss: 0.0869 | F1: 0.6475 | Precision: 0.7745 | Recall: 0.5563

Epoch : 25
Train Loss: 0.0454 | F1: 0.8131 | Precision: 0.8651 | Recall: 0.7669
Valid Loss: 0.0840 | F1: 0.7092 | Precision: 0.8165 | Recall: 0.6268

Epoch : 26
Train Loss: 0.0425 | F1: 0.8219 | Precision: 0.8844 | Recall: 0.7676
Valid Loss: 0.0785 | F1: 0.7008 | Precision: 0.7946 | Recall: 0.6268

New best valid loss: 0.0785 at epoch 26, saving model checkpoint.
Epoch : 27
Train Loss: 0.0416 | F1: 0.8237 | Precision: 0.8769 | Recall: 0.7766
Valid Loss: 0.0934 | F1: 0.6458 | Precision: 0.6370 | Recall: 0.6549

Epoch : 28
Train Loss: 0.0391 | F1: 0.8363 | Precision: 0.8931 | Recall: 0.7863
Valid Loss: 0.0808 | F1: 0.7287 | Precision: 0.8103 | Recall: 0.6620

Epoch : 29
Train Loss: 0.0360 | F1: 0.8609 | Precision: 0.9107 | Recall: 0.8162
Valid Loss: 0.0750 | F1: 0.7059 | Precision: 0.7965 | Recall: 0.6338

New best valid loss: 0.0750 at epoch 29, saving model checkpoint.
Epoch : 30
Train Loss: 0.0369 | F1: 0.8524 | Precision: 0.8994 | Recall: 0.8100
Valid Loss: 0.0700 | F1: 0.7732 | Precision: 0.8189 | Recall: 0.7324

New best valid loss: 0.0700 at epoch 30, saving model checkpoint.
Epoch : 31
Train Loss: 0.0351 | F1: 0.8604 | Precision: 0.9056 | Recall: 0.8195
Valid Loss: 0.0826 | F1: 0.7455 | Precision: 0.7591 | Recall: 0.7324

Epoch : 32
Train Loss: 0.0361 | F1: 0.8541 | Precision: 0.9022 | Recall: 0.8109
Valid Loss: 0.0815 | F1: 0.6538 | Precision: 0.7203 | Recall: 0.5986

Epoch : 33
Train Loss: 0.0352 | F1: 0.8566 | Precision: 0.9034 | Recall: 0.8144
Valid Loss: 0.0785 | F1: 0.7191 | Precision: 0.7680 | Recall: 0.6761

Epoch : 34
Train Loss: 0.0313 | F1: 0.8684 | Precision: 0.9094 | Recall: 0.8310
Valid Loss: 0.0748 | F1: 0.7045 | Precision: 0.8286 | Recall: 0.6127

Epoch : 35
Train Loss: 0.0335 | F1: 0.8725 | Precision: 0.9069 | Recall: 0.8407
Valid Loss: 0.0755 | F1: 0.7312 | Precision: 0.7445 | Recall: 0.7183

Epoch : 36
Train Loss: 0.0327 | F1: 0.8729 | Precision: 0.9127 | Recall: 0.8364
Valid Loss: 0.0940 | F1: 0.6901 | Precision: 0.6901 | Recall: 0.6901

Epoch : 37
Train Loss: 0.0319 | F1: 0.8718 | Precision: 0.9125 | Recall: 0.8347
Valid Loss: 0.0766 | F1: 0.7266 | Precision: 0.7760 | Recall: 0.6831

Epoch : 38
Train Loss: 0.0288 | F1: 0.8901 | Precision: 0.9242 | Recall: 0.8584
Valid Loss: 0.0772 | F1: 0.7197 | Precision: 0.7787 | Recall: 0.6690

Epoch : 39
Train Loss: 0.0275 | F1: 0.8897 | Precision: 0.9193 | Recall: 0.8619
Valid Loss: 0.0756 | F1: 0.7154 | Precision: 0.7881 | Recall: 0.6549

Epoch : 40
Train Loss: 0.0299 | F1: 0.8786 | Precision: 0.9151 | Recall: 0.8449
Valid Loss: 0.0734 | F1: 0.7402 | Precision: 0.8393 | Recall: 0.6620

Loading best model from epoch 30
Collecting validation probabilities for threshold optimization...
Threshold optimization results:
Best threshold: 0.513
Best validation F1: 0.7761
Validation positive rate: 4.7%
Evaluating on test set:
1. With default threshold (0.5):
Test Loss: 0.0713 | F1: 0.7101 | Precision: 0.7313 | Recall: 0.6901
2. With optimized threshold (0.513):
Test Loss: 0.0713 | F1: 0.7106 | Precision: 0.7405 | Recall: 0.6831
=== THRESHOLD OPTIMIZATION RESULTS ===
F1 improvement: +0.0005 (from 0.7101 to 0.7106)
Optimal threshold: 0.513 (vs default 0.5)
Best validation loss epoch: 30
################## Training is Done! #########################
Creating transition analysis visualization...
Analysis Results: Precision=0.731, Recall=0.690, F1=0.710
TP=98, FP=36, FN=44, TN=2838
Training time is : 0:06:31.334413
